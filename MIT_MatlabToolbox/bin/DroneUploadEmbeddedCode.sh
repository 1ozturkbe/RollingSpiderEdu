#!/bin/bash

# 1. change folder to where this script is
cd `dirname $0`
SCRIPTPATH=$(pwd)

# 1.2 Exit the script if a command fails
set -e

# 2. Pack autogenerated c-code
cd utils/
./PackEmbeddedCode
cd ..

# 3. Build code
cd ../trunk/embcode/build_arm
make
cd $SCRIPTPATH
# 4. ftp into the drone and upload the shared library
echo "> Drone: FTP into the drone"
/usr/bin/expect -c 'set timeout -1; spawn ftp 192.168.1.1; expect "(192.168.1.1:'"$USER"'):"; send "\r"; expect "ftp>"; send "put ../DroneExchange/librsedu.so librsedu.so\r"; expect "ftp>"; send "exit\r"; expect eof'
